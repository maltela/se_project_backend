package de.management.dao;
import java.util.ArrayList;

import javax.annotation.PostConstruct;
import javax.annotation.Resource;
import javax.ejb.EJB;
import javax.ejb.Singleton;
import javax.ejb.Startup;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;

import org.jboss.logging.Logger;

import de.management.entities.Event;
import de.management.entities.User;

@Startup
@Singleton
/** Beispieldaten Beladung / Objekte verfizieren 
 * 	@author Malte Lange 
 * */
public class DataBuilder {
	private static final Logger logger = Logger.getLogger(DataBuilder.class);
	

	
	@PersistenceContext
	EntityManager em;
	
	@Resource
	private String Event;

	@PostConstruct
	private void init() {
		User user1 = new User("USer1","23432");	
		em.persist(user1);
		logger.info("User angelegt:");
		User userdb = em.find(User.class,1);
		logger.info(userdb.getName()+ " "+userdb.getUserID());
		de.management.entities.Event event1 = new de.management.entities.Event ("Majom-Event1","Intialisierungs-Veranstaltung","01/08/2015","02/08/2015");
		de.management.entities.Event event2 = new de.management.entities.Event ("Majom-Event2","Intialisierungs-Veranstaltung","03/08/2015","04/08/2015");
		de.management.entities.Event event3 = new de.management.entities.Event ("Majom-Event3","Intialisierungs-Veranstaltung","05/08/2015","06/08/2015");
		logger.info(event1.getName());
		em.persist(event1);
		Query querytest = em.createQuery("Select e from Event e where e.Name ='Majom-Event1'");
		de.management.entities.Event e = (de.management.entities.Event)querytest.getSingleResult();
		logger.info(e.getName()+" "+ e.getNr());
		
		Query query3 = em.createQuery("select e from Event e join e.users u where e.ID = :param ");
		query3.setParameter("param",2);
		
		@SuppressWarnings("unchecked")
		ArrayList<Event> list = (ArrayList<Event>) query3.getResultList();
		logger.info(list.toString());
	
	}
			
	
		
	}





